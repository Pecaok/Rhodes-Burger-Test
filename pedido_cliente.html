<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Confirmar pedido ‚Ä¢ Rhodes Burgers</title>
  <link rel="icon" href="images/logo.png" />

  <style>
    :root{ --primary:#625A45; --text:#111; --muted:#666; --bg:#f6f6f6; --card:#fff; --radius:18px; --shadow:0 10px 30px rgba(0,0,0,.08); --ring:#eaeaea; }
    *{box-sizing:border-box}
    html,body{ margin:0; background:var(--bg); color:var(--text); font-family:system-ui,Segoe UI,Roboto,Inter,Arial,sans-serif }
    #pageLoader { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: #000000; z-index: 99999; display: flex; align-items: center; justify-content: center; transition: opacity 0.5s ease, visibility 0.5s; }
    #pageLoader.hidden { opacity: 0; visibility: hidden; pointer-events: none; }
    #pageLoader video { width: 250px; max-width: 90%; height: auto; object-fit: contain; mix-blend-mode: screen; }
    @media (min-width: 768px) { #pageLoader video { width: 500px; } }
    header{ position:sticky; top:0; z-index:10; background:#fff; box-shadow:0 2px 12px rgba(0,0,0,.06) }
    .topbar{ max-width:1100px; margin:0 auto; padding:10px 12px; display:flex; align-items:center; gap:12px }
    .brand{ display:flex; align-items:center; text-decoration:none; color:inherit; font-weight:700 }
    .brand img{ width:36px;height:36px; border-radius:10px; background:#fff; object-fit:contain;margin-right:8px }
    .spacer{flex:1}
    .btn{ display:inline-flex; align-items:center; gap:8px; border:2px solid var(--primary); background:#fff; color:var(--primary); padding:10px 16px; border-radius:999px; font-weight:700; cursor:pointer; text-decoration:none }
    .btn.primary{background:var(--primary);color:#fff}
    .btn.ghost{border-color:#e7e7e7;color:#333}
    .btn.small{padding:6px 10px;border-radius:8px;font-size:14px}
    .btn.disabled,.btn[disabled]{opacity:.6;pointer-events:none}
    main{ max-width:1100px; margin:24px auto; padding:0 12px; display:grid; grid-template-columns:1fr 420px; gap:18px }
    @media(max-width:900px){main{grid-template-columns:1fr}}
    .card{ background:var(--card); border-radius:var(--radius); box-shadow:var(--shadow); padding:16px }
    h1{font-size:32px;margin:10px 0 18px}
    label{font-weight:600;margin:6px 0;display:block}
    input[type=text], textarea { width:100%; padding:12px; border:1px solid var(--ring); border-radius:12px; font-size: 15px; background: #fff; font-family: inherit; }
    .group{margin:14px 0}
    .chips{display:flex;gap:12px;flex-wrap:wrap}
    .chip{ display:flex; align-items:center; gap:8px; border:1px solid var(--ring); padding:10px 16px; border-radius:999px; background:white; cursor:pointer; }
    .chip input{accent-color:var(--primary)}
    .muted{color:var(--muted)}
    .muted-small{color:var(--muted);font-size:13px;margin-top:6px}
    .actions{display:flex;gap:10px;margin-top:12px}
    .actions .btn{flex:1}
    /* SLOTS */
    .carousel{display:flex;align-items:center;gap:12px;margin-top:8px}
    .arrow{ width:44px;height:44px; border-radius:10px; border:1px solid var(--ring); display:inline-grid; place-items:center; cursor:pointer; background:#fff }
    .arrow.disabled{opacity:.5;cursor:not-allowed}
    .slot-display{ min-width:200px; padding:10px 14px; border-radius:10px; background:#fff; border:1px solid var(--ring); text-align:center; font-weight:800 }
    .slot-sub{font-size:13px;color:var(--muted);margin-top:6px}
    .slot-meta{font-size:13px;color:#666;margin-top:8px}
    .no-slots{color:#b00020;font-weight:700}
  </style>
</head>

<body>

<div id="pageLoader"><video autoplay loop muted playsinline><source src="images/loader.mp4" type="video/mp4"><img src="images/logo.png" alt="Cargando..." style="width:100px;"></video></div>

<header>
  <div class="topbar">
    <a class="brand" href="index.html"><img src="images/logo.png"/>Rhodes Burgers</a>
    <div class="spacer"></div>
    <a class="btn ghost" href="index.html">‚Üê Seguir comprando</a>
  </div>
</header>

<main>
<section class="card">
  <h1>Confirmar pedido</h1>
  <div class="group"><label>Nombre y apellido</label><input id="inpNombre" type="text" placeholder="Ej: Juan P√©rez"/></div>
  <div class="group"><label>Tel√©fono (opcional)</label><input id="inpTelefono" type="text" placeholder="Para contactarte si es necesario"/></div>
  <div class="group">
    <label>Medio de pago</label>
    <div style="background-color: #fff8e1; border: 1px solid #ffe0b2; color: #e65100; padding: 14px; border-radius: 12px; text-align: center; font-weight: 800; font-size: 15px; display: flex; align-items: center; justify-content: center; gap: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.05);">
      <svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16"><path d="M8 1a2.5 2.5 0 0 1 2.5 2.5V4h-5v-.5A2.5 2.5 0 0 1 8 1zm3.5 3v-.5a3.5 3.5 0 1 0-7 0V4H1v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V4h-3.5zM2 5h12v9a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V5z"/></svg>
      Abon√°s en el local al retirar
    </div>
  </div>
  <div class="group">
    <label>Tipo de entrega</label>
    <div class="chips"><label class="chip"><input type="radio" name="entrega" value="take_away" checked> Take Away</label></div>
    <div class="muted-small">* Solo retiro por el local.</div>
  </div>
  <div class="group">
    <label>Horario de retiro (solo hoy)</label>
    <div style="display:flex;gap:8px;align-items:center">
      <div class="carousel" id="slotsCarousel">
        <div id="slotPrev" class="arrow">‚óÄ</div>
        <div id="slotLabel" class="slot-display">Cargando‚Ä¶</div>
        <div id="slotNext" class="arrow">‚ñ∂</div>
      </div>
      <div style="display:flex;flex-direction:column;gap:6px;margin-left:8px">
        <button id="btnRefreshSlots" class="btn ghost small">üîÅ</button>
        <div id="slotCount" class="slot-sub"></div>
      </div>
    </div>
    <div id="slotNote" class="slot-meta">Cargando turnos...</div>
  </div>
  <div class="group"><label>Notas (opcional)</label><textarea id="inpNotas" placeholder="Aclaraciones sobre el pedido..."></textarea></div>
  <div class="group" style="border-top: 1px dashed var(--ring); padding-top: 14px;">
    <label>Cup√≥n de descuento</label>
    <div style="display:flex; gap:8px;">
        <input id="inpCupon" type="text" placeholder="C√ìDIGO" style="text-transform:uppercase; letter-spacing:1px; font-weight:700;">
        <button id="btnAplicarCupon" class="btn ghost small">Aplicar</button>
    </div>
    <div id="msgCupon" class="muted-small"></div>
  </div>
  <div class="actions"><a class="btn ghost" href="index.html">Cancelar</a><button id="btnConfirmar" class="btn primary">Confirmar Pedido</button></div>
</section>
<aside class="card right"><h3>Resumen</h3><div id="resumen"></div><div style="display:flex;justify-content:space-between;margin-top:12px"><strong>Total</strong><strong id="resTotal">$0</strong></div></aside>
</main>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script>
const firebaseConfig={apiKey:"AIzaSyBbt5YOWDE0ouLn-Ib_iD1yUesok5SEhB8",authDomain:"rhodes-burguers.firebaseapp.com",projectId:"rhodes-burguers",storageBucket:"rhodes-burguers.firebasestorage.app",messagingSenderId:"951646688091",appId:"1:951646688091:web:05db5fadb4150d1fa9c07e"};
firebase.initializeApp(firebaseConfig);
const db=firebase.firestore();

const CART_KEY="rhodes_cart_v3";
const GRAMOS_POR_BLOQUE=1500;
const G_POR_BURGER=200;
const G_POR_SIDE=350; 
const SLOT_START="19:15"; const SLOT_END="23:45"; const SLOT_INTERVAL_MIN=15;
const WHATSAPP_NUMBER = "5491170596483"; 
let PRICE_PATTY = 2800; let PRICE_CHEDDAR = 300;
let activeDiscount = 0; let activeCouponCode = "";

function $(s){ return document.querySelector(s); }
function parseHHMM(str){ const [h,m]=str.split(":").map(Number); const now=new Date(); return new Date(now.getFullYear(),now.getMonth(),now.getDate(),h,m,0); }
function slotKey(date){ const y=date.getFullYear(); const M=String(date.getMonth()+1).padStart(2,"0"); const d=String(date.getDate()).padStart(2,"0"); const H=String(date.getHours()).padStart(2,"0"); const m=String(date.getMinutes()).padStart(2,"0"); return `${y}${M}${d}_${H}${m}`; }
function formatHHMM(date){ return date.toLocaleTimeString("es-AR",{hour:"2-digit",minute:"2-digit",hour12:false}); }
function normalizeFriesLabel(raw){ if(!raw) return ''; let s=String(raw).toLowerCase().replace(/[_-]/g,' ').trim(); if(s.includes("sazon"))return "Sazonadas"; if(s.includes("sin sal"))return "Sin sal"; if(s.includes("con sal")||s.includes("sal"))return "Con Sal"; return ''; }
function generateToken() { return Math.random().toString(36).substr(2) + Date.now().toString(36); }

// üî• Helper para normalizar texto (quita acentos y min√∫sculas)
function normalizeStr(str) { return String(str||"").toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g, ""); }

db.collection('config').doc('prices').onSnapshot(doc => { if(doc.exists) { const d = doc.data(); if(d.patty) PRICE_PATTY = Number(d.patty); if(d.cheddar) PRICE_CHEDDAR = Number(d.cheddar); renderResumen(); } });

function loadCart(){ try{ return JSON.parse(localStorage.getItem(CART_KEY))||{burger:{},drink:{},side:{}}; }catch{ return {burger:{},drink:{},side:{}}; } }

// üî• C√ÅLCULO DE GRAMOS CORREGIDO (Usa normalizaci√≥n para detectar "Porci√≥n" con tilde)
function gramosDelPedido(){ 
    const c = loadCart(); 
    let g = 0; 
    
    // 1. Revisar Burger (Hamburguesas y Guarniciones Personalizables)
    for(const k in c.burger) {
        const item = c.burger[k].item;
        const qty = c.burger[k].qty || 0;
        const name = normalizeStr(item.name); // Normalizamos aqu√≠ para quitar tildes

        // Si es Porci√≥n de papas (busca "porcion" sin tilde gracias a normalizeStr)
        if (name.includes("porcion") && (name.includes("papa") || name.includes("frita"))) {
            g += qty * 350;
        } else {
            g += qty * 200; // Hamburguesas
        }
    }
    
    // 2. Revisar Side (Items simples)
    for(const k in c.side) { 
        // Tambi√©n chequeamos aqu√≠ por seguridad
        const item = c.side[k].item;
        const name = normalizeStr(item.name);
        if (name.includes("porcion") && (name.includes("papa") || name.includes("frita"))) {
             g += (c.side[k].qty||0) * 350;
        } else {
             g += (c.side[k].qty||0) * 350; // Asumimos guarniciones grandes por defecto si caen ac√°
        }
    }
    return g; 
}

let slotObjects=[], visibles=[], listeners=[], currentIndex=0;
function limpiarListeners(){ listeners.forEach(u=>{try{u()}catch{}}); listeners=[]; }
async function cargarSlots(){
  limpiarListeners();
  const slots=[]; let cur=new Date(parseHHMM(SLOT_START)); const end=parseHHMM(SLOT_END);
  while(cur<=end){ slots.push(new Date(cur)); cur=new Date(cur.getTime()+SLOT_INTERVAL_MIN*60000); }
  slotObjects=slots.map(d=>({date:d, key:slotKey(d), gramsUsed:0, full:false}));
  $("#slotLabel").textContent="Cargando‚Ä¶";
  slotObjects.forEach(s=>{
    const ref=db.collection("slots_grams").doc(s.key);
    const unsub=ref.onSnapshot(doc=>{
      if(!doc.exists) ref.set({gramsUsed:0},{merge:true});
      const data=doc.data()||{}; s.gramsUsed=Number(data.gramsUsed||0); s.full=false;
      reconstruirVisibles();
    });
    listeners.push(unsub);
  });
}

function reconstruirVisibles(){
  const pedidoGramos = gramosDelPedido();
  visibles = slotObjects.filter(s=>{
    const restante = GRAMOS_POR_BLOQUE - s.gramsUsed;
    if(restante<=0) return false;
    if(pedidoGramos>GRAMOS_POR_BLOQUE) return true;
    return restante>=pedidoGramos;
  });
  const now=new Date(); const m=now.getMinutes(); const q=Math.floor(m/15)*15;
  const base=new Date(now); base.setMinutes(q); base.setSeconds(0); base.setMilliseconds(0);
  const cutoff=new Date(base.getTime()+20*60000);
  visibles = visibles.filter(s=>s.date>=cutoff).sort((a,b)=>a.date-b.date);
  if(visibles.length===0) currentIndex=-1; else if(currentIndex<0||currentIndex>=visibles.length) currentIndex=0;
  actualizarUI();
}

function actualizarUI(){
  const label=$("#slotLabel"), car=$("#slotsCarousel");
  if(visibles.length===0){ label.innerHTML="<div class='no-slots'>No hay turnos</div>"; car.selectedSlot=null; return; }
  const s=visibles[currentIndex];
  label.textContent=formatHHMM(s.date); $("#slotNote").textContent="Disponibles";
  car.selectedSlot={ key:s.key, pretty:formatHHMM(s.date) };
}

$("#slotPrev").onclick=()=>{if(currentIndex>0){currentIndex--;actualizarUI()}};
$("#slotNext").onclick=()=>{if(currentIndex<visibles.length-1){currentIndex++;actualizarUI()}};
$("#btnRefreshSlots").onclick=cargarSlots;
setInterval(reconstruirVisibles,10000);

function renderResumen(){
  const c=loadCart(); const box=$("#resumen"); box.innerHTML=""; let t=0;
  for(const o of Object.values(c.burger)){
    const extrasCost = (o.extras?.patty||0)*PRICE_PATTY + (o.extras?.cheddar||0)*PRICE_CHEDDAR;
    const unitPrice = o.item.price + extrasCost;
    const subt = o.qty * unitPrice;
    t += subt;
    let extrasHtml = "";
    if(o.extras?.patty) extrasHtml += `<div class="muted">‚Ä¢ Extra carne: +${o.extras.patty}</div>`;
    if(o.extras?.cheddar) extrasHtml += `<div class="muted">‚Ä¢ Extra cheddar: +${o.extras.cheddar}</div>`;
    let labelPapas = "Papas: "; if(o.item.category === 'guarniciones') labelPapas = "Estilo: ";
    box.innerHTML+=`<div style="margin-bottom:8px"><strong>${o.item.name} x${o.qty}</strong>${extrasHtml} <div class="muted">${labelPapas}${normalizeFriesLabel(o.fries)}</div><div class="muted">Subtotal: $${subt.toLocaleString("es-AR")}</div></div>`;
  }
  for(const k in c.drink){ t += c.drink[k].qty * c.drink[k].item.price; }
  for(const k in c.side){ t += c.side[k].qty * c.side[k].item.price; }
  let finalTotal = t - activeDiscount; if(finalTotal < 0) finalTotal = 0;
  if(activeDiscount > 0) { box.innerHTML += `<div style="margin-top:10px; padding-top:10px; border-top:1px dashed #ccc; color: #16a34a; font-weight:700;">üè∑Ô∏è Cup√≥n (${activeCouponCode}): -$${activeDiscount.toLocaleString("es-AR")}</div>`; }
  $("#resTotal").textContent="$ "+finalTotal.toLocaleString("es-AR");
  return finalTotal;
}

$("#btnAplicarCupon").onclick = async () => {
    const code = $("#inpCupon").value.trim().toUpperCase(); const msg = $("#msgCupon");
    if(!code) return; $("#btnAplicarCupon").textContent = "‚è≥";
    try {
        const snap = await db.collection('coupons').where('code', '==', code).where('active', '==', true).get();
        if(snap.empty) { msg.textContent = "‚ùå Cup√≥n inv√°lido o expirado"; msg.style.color = "#dc2626"; activeDiscount = 0; activeCouponCode = ""; } 
        else { const data = snap.docs[0].data(); if(data.amount) { activeDiscount = Number(data.amount); activeCouponCode = code; msg.textContent = `‚úÖ ¬°Descuento de $${activeDiscount} aplicado!`; msg.style.color = "#16a34a"; } }
    } catch(e) { console.error(e); msg.textContent = "Error al verificar"; }
    renderResumen(); $("#btnAplicarCupon").textContent = "Aplicar";
};

async function obtenerYIncrementarOrderNumber() {
  const ref = db.collection("config").doc("counters"); let nuevoNumero = null;
  await db.runTransaction(async (tx)=>{ const snap = await tx.get(ref); const actual = snap.exists ? snap.data().orderNumber || 0 : 0; nuevoNumero = actual + 1; tx.set(ref, { orderNumber: nuevoNumero }, {merge:true}); });
  return nuevoNumero;
}

async function reservarMultiBloque(horaInicioKey, gramosTotales) {
  const idx=slotObjects.findIndex(s=>s.key===horaInicioKey); if(idx===-1) throw new Error("NO_SLOT");
  const cant=Math.ceil(gramosTotales/GRAMOS_POR_BLOQUE); let blqs=[]; let rest=gramosTotales;
  for(let i=0;i<cant;i++){ const s=slotObjects[idx+i]; if(!s) throw new Error("SIN_BLOQUES"); let carga=Math.min(rest,GRAMOS_POR_BLOQUE); blqs.push({key:s.key, carga:carga, usados:s.gramsUsed}); rest-=carga; }
  for(const b of blqs){ if(b.usados+b.carga>GRAMOS_POR_BLOQUE) throw new Error("NO_CAPACIDAD"); }
  for(const b of blqs){ await db.runTransaction(async tx=>{ const ref=db.collection("slots_grams").doc(b.key); const snap=await tx.get(ref); const act=snap.exists?Number(snap.data().gramsUsed||0):0; tx.set(ref,{gramsUsed:act+b.carga},{merge:true}); }); }
}

$("#btnConfirmar").onclick=async()=>{
  const btn=$("#btnConfirmar"); const nombre=$("#inpNombre").value.trim(); const tel=$("#inpTelefono").value.trim(); const pagoVal = ""; const notas=$("#inpNotas").value.trim(); const slot=$("#slotsCarousel").selectedSlot; const cart=loadCart();
  if(!nombre){ alert("Ingres√° tu nombre"); return; } if(!slot){ alert("Eleg√≠ un horario de retiro"); return; }
  let items=0; Object.values(cart.burger).forEach(o=>items+=o.qty); Object.values(cart.drink).forEach(o=>items+=o.qty); Object.values(cart.side).forEach(o=>items+=o.qty);
  if(items===0){alert("Carrito vac√≠o");return;}
  btn.disabled=true; btn.textContent="Procesando...";
  localStorage.setItem('rb_user_name', nombre); if(tel) localStorage.setItem('rb_user_phone', tel);
  try{
    await reservarMultiBloque(slot.key, gramosDelPedido());
    const orderNumber = await obtenerYIncrementarOrderNumber();
    const trackToken = generateToken();
    let totalCalculado=0; let detalle="";
    for(const o of Object.values(cart.burger)){
       const extrasCost = (o.extras?.patty||0)*PRICE_PATTY + (o.extras?.cheddar||0)*PRICE_CHEDDAR; const unitTotal = o.item.price + extrasCost; totalCalculado += o.qty * unitTotal;
       let exTxt = ""; if(o.extras?.patty) exTxt += ` (+${o.extras.patty} carne)`; if(o.extras?.cheddar) exTxt += ` (+${o.extras.cheddar} cheddar)`;
       detalle+=`‚Ä¢ ${o.item.name} x${o.qty} ${exTxt} (${normalizeFriesLabel(o.fries)})\n`; if(o.notes) detalle+=`   Nota: ${o.notes}\n`;
    }
    for(const o of Object.values(cart.drink)){ totalCalculado += o.qty * o.item.price; detalle+=`‚Ä¢ ${o.item.name} x${o.qty}\n`; }
    for(const o of Object.values(cart.side)){ totalCalculado += o.qty * o.item.price; detalle+=`‚Ä¢ ${o.item.name} x${o.qty}\n`; }
    let totalFinal = totalCalculado - activeDiscount; if(totalFinal < 0) totalFinal = 0;
    const now = new Date(); const localDate = new Date(now.getTime() - (now.getTimezoneOffset() * 60000)); const localISO = localDate.toISOString().slice(0, -1); 
    
    // üî• CORRECCI√ìN: AHORA ENVIAMOS "fries" y "notes" TAMBI√âN PARA LOS SIDES
    const allItems = [
        ...Object.values(cart.burger).map(o=>({ type: 'burger', name:o.item.name, price:o.item.price, qty:o.qty, fries:o.fries, notes:o.notes?[o.notes]:[], extras:{patty:o.extras.patty, cheddar:o.extras.cheddar, EXTRA_PRICE_PATTY:PRICE_PATTY, EXTRA_PRICE_CHEDDAR:PRICE_CHEDDAR} })),
        ...Object.values(cart.drink).map(o=>({ type: 'drink', name:o.item.name, price:o.item.price, qty:o.qty, category: 'bebida' })),
        
        // üî• ESTE ES EL CAMBIO CLAVE PARA QUE LLEGUE LA SAL/SAZONADOR AL LOCAL
        ...Object.values(cart.side).map(o=>({ 
            type: 'side', 
            name:o.item.name, 
            price:o.item.price, 
            qty:o.qty, 
            category: 'guarnicion',
            fries: o.fries,         // <--- AGREGADO
            notes: o.notes?[o.notes]:[] // <--- AGREGADO
        }))
    ];

    const pedidoData = { source:"web", orderNumber, nombre, telefono: tel, pago: pagoVal, payment_method: pagoVal, payment_status:"pending_payment", paid:false, entrega:"take_away", pickup_time_pretty:slot.pretty, pickup_slot:slot.key, status:"accepted", statusHistory:[{to:"accepted",at:localISO}], items: allItems, total: totalFinal, subtotal: totalCalculado, discount: activeDiscount, coupon: activeCouponCode, createdAt: localISO, trackToken: trackToken };
    const docRef = await db.collection("orders").add(pedidoData);
    await db.collection("order_public").doc(trackToken).set({ orderNumber, nombre, status: "accepted", updatedAt: localISO, entrega: "take_away", pago: pagoVal, payment_status: "pending_payment" });
    let baseUrl = window.location.href.split('?')[0]; if(baseUrl.endsWith('.html')) baseUrl = baseUrl.substring(0, baseUrl.lastIndexOf('/')); if(baseUrl.endsWith('/')) baseUrl = baseUrl.substring(0, baseUrl.length - 1);
    const trackLink = `${baseUrl}/gracias.html?id=${docRef.id}&t=${trackToken}`;
    const msg = `*Nuevo Pedido #${orderNumber}*\nNombre: ${nombre}\nPago: A Coordinar / En el local\nRetiro: ${slot.pretty}\n\n${detalle}\n${activeDiscount > 0 ? `Cup√≥n ${activeCouponCode}: -$${activeDiscount}\n` : ''}*Total:* $${totalFinal.toLocaleString("es-AR")}\n\nüîó *Segu√≠ tu pedido ac√°:*\n${trackLink}`;
    localStorage.removeItem(CART_KEY);
    window.open("https://wa.me/"+WHATSAPP_NUMBER+"?text="+encodeURIComponent(msg), '_blank');
    setTimeout(() => { window.location.href = trackLink; }, 500);
  }catch(e){ console.error(e); alert("Ocurri√≥ un error: "+e.message); cargarSlots(); btn.disabled=false; btn.textContent="Confirmar Pedido"; }
};

window.addEventListener("DOMContentLoaded",()=>{
    cargarSlots(); renderResumen();
    const savedName = localStorage.getItem('rb_user_name'); const savedPhone = localStorage.getItem('rb_user_phone');
    if(savedName) $("#inpNombre").value = savedName; if(savedPhone) $("#inpTelefono").value = savedPhone;
    setTimeout(() => { const loader = document.getElementById("pageLoader"); if(loader) { loader.classList.add("hidden"); setTimeout(()=>loader.remove(), 500); } }, 1500);
});
</script>
</body>
</html>
